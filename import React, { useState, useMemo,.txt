import React, { useState, useMemo, useEffect } from 'react';
import { 
  ChevronRight, 
  ChevronLeft, 
  Search, 
  Layout, 
  Shield, 
  AlertTriangle, 
  Activity, 
  Target, 
  Zap, 
  SearchCode,
  List,
  Clock,
  Settings,
  ShieldAlert,
  Terminal,
  FileSearch,
  BookOpen,
  ArrowUpRight,
  Database
} from 'lucide-react';

const SOC_DATA = [
  { id: 1, category: "Basics", title: "Alert (هشدار)", def: "یک «هشدار خودکار» از SIEM/EDR که می‌گوید یک الگو/رفتار مشکوک دیده شده و نیاز به بررسی دارد.", when: "وقتی یک Rule/Use Case فعال می‌شود؛ مثلاً چند لاگین ناموفق یا اجرای PowerShell مشکوک.", usage: "شروع کار Tier1: بررسی سریع، اولویت‌بندی، تشخیص FP/TP و ثبت Ticket.", why: "جدا کردن «چیزهای مهم» از حجم عظیم لاگ‌ها تا تیم انسانی فقط موارد لازم را ببیند.", how: "باز کردن هشدار → بررسی جزئیات → چک کردن شواهد کناری → تصمیم (FP/TP) → ثبت تیکت.", tips: "بازه زمانی را درست تنظیم کن. به Context دقت کن. بدون شواهد نتیجه‌گیری نکن.", note: "Alert «خودِ حادثه» نیست؛ فقط «سیگنال» است و نیاز به همبستگی (Correlation) دارد." },
  { id: 2, category: "Basics", title: "Triage (تریاژ)", def: "بررسی سریع و ساختاریافته برای فهم اینکه هشدار چقدر جدی است و باید چه کار کرد.", when: "بلافاصله پس از دریافت هشدار، قبل از ورود به بررسی عمیق.", usage: "تصمیم‌گیری سریع: مهم/کم‌اهمیت، FP/TP، تعیین قدم بعدی.", why: "جلوگیری از هدر رفت زمان تیم و کاهش Alert Fatigue (خستگی از هشدارها).", how: "چک‌لیست: مربوط به چیست؟ کی/کجا؟ شدت؟ تکرار؟ نشانه‌های نفوذ؟", tips: "نتیجه را در تیکت بنویس. روی بدترین سناریو قفل نشو؛ مبتنی بر شواهد باش.", note: "Triage یعنی تصمیم سریع با داده کافی؛ نه بررسی عمیق. عمق زیاد مربوط به Investigation است." },
  { id: 3, category: "Basics", title: "Investigation (تحقیق)", def: "جمع‌کردن شواهد و ساختن تصویر دقیق از اینکه «چی شده، چطور، از کجا، چقدر گسترده».", when: "وقتی تریاژ بگوید هشدار ارزش بررسی بیشتر دارد یا احتمال TP هست.", usage: "تایید/رد رخداد، ساخت Timeline، تعیین Scope، آماده‌سازی برای مهار.", why: "با یک لاگ نمی‌توان فهمید واقعاً حمله بوده یا رفتار عادی/اشتباه سیستم.", how: "بررسی لاگ‌های 4625 و 4624، بررسی IPها و الگوها. اگر موفقیت بعد از شکست بود → Brute Force.", tips: "بازه زمانی (Time window) درست. ذخیره شواهد (Query/Screenshot). فراموش نکردن Scope.", note: "هدف در Tier1 معمولاً «جمع‌بندی قابل ارجاع» است، نه پاکسازی کامل سیستم." },
  { id: 4, category: "Basics", title: "Incident (رخداد امنیتی)", def: "یک اتفاق تاییدشده که امنیت را نقض کرده یا احتمال واقعی آسیب دارد (نه فقط هشدار).", when: "وقتی شواهد کافی برای فعالیت بدخواهانه یا نقض سیاست وجود دارد.", usage: "فعال‌کردن فرآیند IR: مهار، بررسی، پاکسازی، بازیابی.", why: "برخورد با Incident باید رسمی‌تر و سریع‌تر باشد (درگیری تیم‌ها، ثبت قانونی).", how: "باز کردن Incident → دسته‌بندی → تعیین شدت و اولویت → درگیر کردن تیم مناسب.", tips: "بدون شواهد تایید شده Incident ایجاد نکن. از کلمات دقیق (Suspected vs Confirmed) استفاده کن.", note: "هر Incident از یک Alert شروع می‌شود، ولی هر Alert تبدیل به Incident نمی‌شود." },
  { id: 5, category: "Data", title: "Event (رویداد)", def: "یک رکورد خام از یک اتفاق در سیستم/شبکه (مثل یک Log entry).", when: "همیشه؛ تمام لاگ‌ها (Login، اجرای پروسس و...) Event هستند.", usage: "مواد خام برای تحلیل: ساخت Correlation، Alert و Investigation.", why: "بدون Eventها هیچ دیدی از اتفاقات داخل سیستم نداریم.", how: "خواندن فیلدها (Time, Host, User, Action) و اتصال به رویدادهای قبل/بعد.", tips: "بدون Context گمراه‌کننده است. کیفیت لاگ‌گیری (Logging) حیاتی است.", note: "Tier1 باید بتواند Event را سریع بخواند و به یک داستان قابل فهم ترجمه کند." },
  { id: 6, category: "Metrics", title: "Severity (شدت)", def: "شدت فنی/امنیتی یک رخداد یا هشدار (چقدر خطرناک به نظر می‌رسد).", when: "برای رتبه‌بندی هشدارها داخل SIEM و تصمیم‌گیری اولیه.", usage: "کمک به اولویت‌بندی رسیدگی به موارد.", why: "رخدادها ارزش یکسان ندارند؛ مثلاً بدافزار روی DC از اسکن پورت سرور تست مهم‌تر است.", how: "بر اساس Rule (Low/High) + انطباق با واقعیت سازمان (Asset criticality).", tips: "سیستم همیشه درست نمی‌گوید؛ با واقعیت تطبیق بده. Critical نیاز به شواهد دارد.", note: "Severity با Priority یکی نیست. ممکن است شدید باشد ولی فوری نباشد." },
  { id: 7, category: "Metrics", title: "Priority (اولویت)", def: "ترتیب رسیدگی عملیاتی: الآن کدام مورد باید جلوتر انجام شود.", when: "در صف کاری SOC و تیکتینگ وقتی چندین مورد همزمان وجود دارد.", usage: "مدیریت زمان و منابع تیم: چی زودتر، چی بعدتر.", why: "برای رعایت SLA و جلوگیری از از دست رفتن رخدادهای حیاتی.", how: "ترکیبی از Severity، Impact، اهمیت دارایی (Asset Criticality) و فوریت (Urgency).", tips: "دارایی حیاتی (مثل DC) حتی با Severity متوسط ممکن است Priority بالا بگیرد.", note: "Tier1 باید بین «فوری» و «مهم» تعادل برقرار کند." },
  { id: 8, category: "Analysis", title: "False Positive (FP)", def: "هشداری که سیستم مشکوک تشخیص داده ولی در واقع رفتار طبیعی/بی‌خطر بوده است.", when: "وقتی پس از بررسی شواهدی از حمله یا نقض یافت نشد.", usage: "بستن تیکت و کمک به Tuning (تنظیم بهتر قوانین) برای کاهش نویز.", why: "اگر FPها زیاد باشند، تیم کور شده و موارد واقعی (TP) را از دست می‌دهد.", how: "بررسی هشدار (مثل اجرای PowerShell توسط ادمین) و تایید بی‌خطر بودن.", tips: "با دلیل مستند کن. اگر تکراری است پیشنهاد Tuning یا Whitelist بده.", note: "اعلام FP نباید حدسی باشد؛ باید قابل دفاع و ممیزی باشد." },
  { id: 9, category: "Analysis", title: "True Positive (TP)", def: "هشداری که واقعاً یک تهدید، نقض یا فعالیت بدخواهانه را نشان می‌دهد.", when: "وقتی شواهد کافی (Hash, IP, Compromise) برای تایید رخداد وجود دارد.", usage: "شروع Incident Workflow، ارجاع به سطح بالاتر و اقدامات پاسخ (Response).", why: "واکنش سریع سازمان برای کاهش خسارت.", how: "جمع‌آوری شواهد (Logs, Timeline) → آپدیت تیکت به Confirmed TP → ارجاع به Tier2.", tips: "همیشه «چه چیزی»، «چرا» و «شواهد» را بنویس. Scope را حدس نزن؛ بررسی کن.", note: "TP می‌تواند از یک هشدار کوچک شروع شود. Low Severity هم می‌تواند شروع زنجیره حمله باشد." },
  { id: 10, category: "Process", title: "Escalation (ارجاع)", def: "انتقال کیس به Tier بالاتر یا تیم تخصصی‌تر در صورت نیاز به تحلیل عمیق‌تر.", when: "TP محتمل، نیاز به دسترسی خاص (Isolate/Block) یا موضوع خارج از دامنه Tier1.", usage: "سرعت دادن به پاسخ و درگیر کردن افراد متخصص.", why: "Tier1 وظیفه تریاژ دارد؛ اقدامات حساس و عمیق به عهده Tier2/IR است.", how: "ارائه خلاصه ۳ خطی، شواهد کلیدی (IOC/Logs)، Timeline و اقدام پیشنهادی در تیکت.", tips: "ارجاع بدون داده ناقص است و برگشت می‌خورد. سطح اطمینان را مشخص کن.", note: "یک Escalation خوب یعنی Tier2 در ۱۰ دقیقه اول گیج نشود." },
  { id: 11, category: "Tools", title: "SIEM", def: "پلتفرمی که لاگ‌ها را جمع‌آوری، همبستگی (Correlation) انجام داده و هشدار می‌سازد.", when: "برای داشتن دید مرکزی روی کل سازمان: لاگ‌ها، جستجو و گزارش.", usage: "تجمیع لاگ، ساخت Alert، تحقیق، داشبورد و نگهداری لاگ‌ها.", why: "بدون SIEM داده‌ها پراکنده‌اند و نمی‌توان فهمید «چی کجا اتفاق افتاد».", how: "اتصال منابع لاگ → اجرای Query → تعریف Rule → مدیریت Case.", tips: "فیلدها باید درست نرمال‌سازی شوند. همسان‌سازی زمان (Time sync) حیاتی است.", note: "SIEM بدون لاگ درست، مثل دوربین بدون تصویر است." },
  { id: 12, category: "Tools", title: "EDR / XDR", def: "EDR رفتار سیستم‌های کاربر/سرور را مانیتور کرده و امکان پاسخ (Isolate) می‌دهد. XDR گسترده‌تر است.", when: "وقتی موضوع روی خود سیستم‌هاست: پروسس‌ها، فایل‌ها، رجیستری.", usage: "تشخیص تهدید روی Endpoint، شکار تهدید و واکنش سریع (Kill process).", why: "EDR رفتار واقعی را می‌بیند در حالی که SIEM فقط لاگ‌ها را دریافت می‌کند.", how: "بررسی Alert → مشاهده Process Tree → چک کردن Hash و Command Line.", tips: "با یک پروسس مشکوک تصمیم سنگین نگیر؛ Context بگیر. اقدامات را ثبت کن.", note: "EDR بهترین دوست Tier1 برای دیدن «پشت‌پرده‌ی هشدار» است." },
  { id: 13, category: "Data", title: "Log Source (منبع لاگ)", def: "هر سیستمی که لاگ تولید کرده و به SIEM می‌فرستد (فایروال، ویندوز، DNS و...).", when: "وقتی می‌خواهید بفهمید برای یک رخداد باید سراغ کدام داده بروید.", usage: "پاسخ به: چه کسی؟ از کجا؟ چی کار کرد؟ روی کجا؟", why: "هر منبع یک زاویه دید می‌دهد؛ نبودنش یعنی Blind Spot (نقطه کور).", how: "فهم نوع رخداد → انتخاب منبع لاگ مناسب → اجرای Query.", tips: "نام‌گذاری و تگ‌گذاری درست مهم است. قطعی لاگ را سریع گزارش کن.", note: "برای Tier1، «دانستن اینکه کجا دنبال چی بگردی» نصف مسیر حل است." },
  { id: 14, category: "Data", title: "Telemetry (تله‌متری)", def: "داده‌های رفتاری/سیستمی که ابزارها از فعالیت‌ها جمع می‌کنند (دقیق‌تر از لاگ ساده).", when: "وقتی می‌خواهید رفتار یک سیستم/کاربر را در طول زمان ببینید.", usage: "ساختن تصویر واقعی از رفتار و کمک به تشخیص تهدید.", why: "حمله‌ها با «رفتار» مشخص می‌شوند؛ تله‌متری الگوها را نشان می‌دهد.", how: "جمع‌آوری (Sysmon/EDR) → حرکت بین نشانه‌ها (Pivot) → ساخت Timeline.", tips: "زمان همگام (Time sync) و فیلتر خوب برای حجم بالای داده.", note: "تله‌متری خوب باعث می‌شود «حدس» کمتر و «اثبات» بیشتر داشته باشید." },
  { id: 15, category: "Analysis", title: "Correlation (همبستگی)", def: "کنار هم قرار دادن چند رویداد/هشدار برای ساخت یک الگوی معنی‌دار.", when: "وقتی یک نشانه به تنهایی کافی نیست و باید زنجیره حمله ساخته شود.", usage: "کشف حملات چندمرحله‌ای (مثل Brute Force موفقیت‌آمیز).", why: "مهاجم‌ها تکی کار نمی‌کنند و رشته‌ای از فعالیت‌ها را انجام می‌دهند.", how: "شروع با یک شاخص (IP/User) → جستجوی رویدادهای مرتبط در بازه زمانی.", tips: "بازه زمانی (Window) مهم است. همبستگی اشتباه می‌تواند FP بسازد.", note: "Correlation خوب = کاهش نویز + افزایش دقت." },
  { id: 16, category: "Detection", title: "Detection Rule (قانون تشخیص)", def: "منطق یا شرطی که در صورت برقراری، سیستم هشدار تولید می‌کند.", when: "برای تبدیل داده خام به هشدارهای قابل پیگیری.", usage: "تشخیص خودکار تهدیدها و رفتارهای غیرعادی.", why: "بدون Rule، باید دستی بین میلیون‌ها لاگ دنبال تهدید بگردید.", how: "انتخاب منبع → تعریف شرط (Threshold/Behavior) → تست و فعال‌سازی.", tips: "باید واضح و قابل عمل (Actionable) باشد. خروجی باید Context بدهد.", note: "قانون خوب قانونی است که به اقدام منجر شود، نه فقط یک اخطار مشکوک." },
  { id: 17, category: "Detection", title: "Use Case (سناریو)", def: "یک سناریوی مشخص که می‌خواهید در سازمان تشخیص دهید (مثل Phishing).", when: "وقتی SOC می‌خواهد پوشش امنیتی را برنامه‌ریزی و استاندارد کند.", usage: "هدف‌گذاری Ruleها، داشبوردها و Playbookها.", why: "نمی‌توان «هر چیزی» را مانیتور کرد؛ باید روی موارد مهم تمرکز کرد.", how: "تعریف تهدید → شناسایی داده لازم → ساخت Rule → تعیین روند پاسخ.", tips: "باید با محیط سازمان هماهنگ باشد. بدون Playbook ناقص می‌ماند.", note: "Use Case دلیل وجود Ruleها است." },
  { id: 18, category: "Threat Intel", title: "IOC (شاخص نفوذ)", def: "نشانه‌ای قابل مشاهده از نفوذ: IP بد، دامنه مخرب، Hash فایل آلوده.", when: "در تریاژ و تحقیق برای جستجو و تطبیق تهدید.", usage: "Hunting (شکار تهدید) و Quick Check در لاگ‌ها/EDR.", why: "سریع‌ترین راه برای پیدا کردن ردپای تهدید در داده‌ها است.", how: "دریافت IOC از منبع معتبر → جستجو در SIEM/EDR → سنجش با Context.", tips: "IOC قدیمی بی‌ارزش است. IPهای مشترک/CDN ممکن است گمراه‌کننده باشند.", note: "IOC به تنهایی «اثبات حمله» نیست؛ فقط یک «سرنخ» است." },
  { id: 19, category: "Threat Intel", title: "Enrichment (غنی‌سازی)", def: "اضافه کردن اطلاعات کمکی به هشدار/IOC (مثل Reputation یا موقعیت جغرافیایی).", when: "وقتی با یک نشانه مواجهید و می‌خواهید سریع خطرناک بودن آن را بفهمید.", usage: "کاهش زمان تریاژ و افزایش دقت در تصمیم‌گیری FP/TP.", why: "داده خام کافی نیست؛ «معنی» لازم است.", how: "استفاده از ابزارهای Reputation (مثل VirusTotal) برای بررسی سابقه شاخص.", tips: "به یک منبع اکتفا نکن. Unknown را سریعاً بی‌خطر فرض نکن.", note: "غنی‌سازی کمک می‌کند قضاوت سریع‌تر ولی مبتنی بر داده باشد." },
  { id: 20, category: "Threat Intel", title: "Threat Intel (TI)", def: "اطلاعات ساختارمند درباره تهدیدها، مهاجم‌ها و تاکتیک‌های آن‌ها (TTP).", when: "برای غنی‌سازی، Hunting و فهم نحوه عملکرد تهدیدها.", usage: "ارتقای تشخیص (Detection)، اولویت‌بندی و جلوگیری از حملات تکراری.", why: "استفاده از تجربه جامعه امنیتی برای دفاع سریع‌تر.", how: "دریافت فیدهای IOC → تطبیق با هشدارها → استفاده برای ساخت قوانین جدید.", tips: "باید مرتبط با صنعت و منطقه شما باشد. TI زیاد و بی‌کیفیت تولید نویز می‌کند.", note: "به جای فقط جمع‌کردن TI، باید آن را به Rule یا Action تبدیل کرد." },
  { id: 21, category: "Analysis", title: "Evidence (شواهد)", def: "داده‌هایی که اتفاق افتادن یا نیفتادن یک رخداد را ثابت می‌کنند (Logs, Screenshots).", when: "در تریاژ، تحقیق، ارجاع و گزارش‌نویسی.", usage: "تصمیم‌گیری درست، دفاع‌پذیری تصمیم‌ها و کمک به تیم‌های بالاتر.", why: "بدون مدرک، نتیجه‌گیری فقط «حدس» است و قابل پیگیری نیست.", how: "ذخیره Queryها و نتایج کلیدی، ثبت Timestamp و منابع لاگ.", tips: "باید قابل بازتولید باشد. زمان‌ها و Timezone را دقیق ثبت کن.", note: "شواهد باید «کم ولی کافی» باشد؛ شلوغ‌کاری باعث گیجی Tier2 می‌شود." },
  { id: 22, category: "Analysis", title: "Artifact (آرتیفکت)", def: "ردپا یا اثر فنی فعالیت (نام فایل، مسیر، رجیستری، Scheduled Task).", when: "وقتی می‌خواهید بفهمید «روی سیستم چی باقی مانده» است.", usage: "شکار تهدید، تایید فعالیت و ساخت IOC داخلی.", why: "حمله‌ها معمولاً آثاری روی سیستم جا می‌گذارند که می‌توان دنبال‌شان گشت.", how: "استخراج از EDR/Sysmon → جستجو روی سایر سیستم‌ها برای یافتن موارد مشابه.", tips: "آرتیفکت ممکن است قانونی (Legit) باشد؛ Context مهم است.", note: "آرتیفکت با IOC فرق دارد؛ آرتیفکت می‌تواند داخلی و بسیار دقیق‌تر باشد." },
  { id: 23, category: "Analysis", title: "Timeline (خط زمانی)", def: "مرتب کردن رخدادها بر اساس زمان برای فهم ترتیب واقعی اتفاقات.", when: "در تحقیق و ارجاع وقتی می‌خواهید «داستان رخداد» را بسازید.", usage: "فهم نقطه شروع، حرکت مهاجم و مراحل بعدی حمله.", why: "بدون ترتیب زمانی، تحلیل زنجیره حمله اشتباه خواهد بود.", how: "تعیین بازه زمانی → مرتب‌سازی رویدادها بر اساس زمان → استخراج نقاط کلیدی.", tips: "اگر زمان سیستم‌ها همگام (Sync) نباشد، Timeline بهم می‌ریزد.", note: "Tier1 معمولاً Timeline کوتاه و کلیدی می‌سازد، نه گزارش طولانی." },
  { id: 24, category: "Basics", title: "Baseline (خط پایه)", def: "تعریف رفتار معمول یک کاربر/سیستم تا ناهنجاری‌ها (Anomaly) مشخص شوند.", when: "برای تشخیص رفتارهای غیرعادی و کاهش هشدارهای اشتباه (FP).", usage: "مقایسه «وضعیت فعلی» با «نرمال گذشته».", why: "بسیاری از رفتارها ذاتاً مشکوک‌اند اما برای یک سیستم خاص ممکن است عادی باشند.", how: "سنجش الگوهای معمول (ساعات کاری، مقصدهای شبکه) و ثبت آن‌ها.", tips: "باید به‌روز شود. برای هر دارایی (Asset) متفاوت است.", note: "بدون Baseline، کلمه «مشکوک» تعریف دقیقی ندارد." },
  { id: 25, category: "Basics", title: "Anomaly (ناهنجاری)", def: "رفتاری که با Baseline سازگار نیست، اما الزاماً حمله نیست.", when: "وقتی رفتاری خارج از الگوی معمول مشاهده می‌شود.", usage: "جرقه (Trigger) برای بررسی بیشتر و کشف تهدیدهای جدید.", why: "خیلی از حملات «امضا» ندارند ولی رفتارشان غیرعادی است.", how: "مشاهده ناهنجاری → بررسی Context (تغییر کاری؟ آپدیت؟) → جمع‌آوری شواهد.", tips: "سریعاً آن را حمله فرض نکن، اما بی‌خیال هم نشو؛ دنبال علت باش.", note: "Tier1 باید ناهنجاری را به سؤال تبدیل کند: «چرا این غیرعادی است؟»" },
  { id: 26, category: "Process", title: "Tuning (تنظیم دقیق)", def: "بهبود قوانین و هشدارها برای کم کردن FP و بالا بردن دقت.", when: "وقتی یک هشدار زیاد تکرار می‌شود یا بی‌کیفیت است.", usage: "کاهش نویز و تمرکز تیم روی موارد واقعی.", why: "SOC با هشدارهای زیاد و بی‌ارزش فلج می‌شود.", how: "بررسی FPهای تکراری → پیدا کردن الگوی بی‌خطر → افزودن استثنا/فیلتر.", tips: "نباید باعث نقطه کور (Blind spot) شود. تغییرات باید قابل بازگشت باشند.", note: "تیونینگ خوب یعنی: «کمتر هشدار بده، ولی باکیفیت‌تر»." },
  { id: 27, category: "Process", title: "Suppression (سرکوب)", def: "توقف موقت یا شرطی تولید یک هشدار برای کاهش نویز.", when: "وقتی فعالیت بی‌خطر ولی پرحجمی (مثل اسکنر امنیتی) باعث سیل هشدار می‌شود.", usage: "حفظ تمرکز تیم و جلوگیری از غرق شدن در هشدارها.", why: "بعضی شرایط کوتاه‌مدت هشدارهای کاذب زیادی تولید می‌کنند.", how: "تعریف شرط سرکوب (IP/Time) → تعیین مدت زمان → بازگشت به حالت عادی.", tips: "باید کنترل‌شده و زمان‌دار باشد. دلیل آن حتماً ثبت شود.", note: "سرکوب اشتباه می‌تواند یک حمله واقعی را پنهان کند." },
  { id: 28, category: "Process", title: "Whitelisting (لیست سفید)", def: "استثنا کردن یک مورد مشخص به عنوان «بی‌خطر» تا دیگر هشدار تولید نکند.", when: "وقتی مطمئن شدید یک شاخص (IP/App) معتبر است ولی زیاد FP می‌سازد.", usage: "کاهش هشدارهای اشتباه و جلوگیری از اتلاف وقت.", why: "بعضی ابزارهای قانونی (بکاپ، مانیتورینگ) رفتاری شبیه تهدید دارند.", how: "اعتبارسنجی مورد → اعمال لیست سفید با دامنه (Scope) محدود.", tips: "لیست سفید زیاد = سوراخ امنیتی. همیشه بازبینی دوره‌ای انجام بده.", note: "بهتر است لیست سفید روی شرایط دقیق باشد (مثلاً Host مشخص + User مشخص)." },
  { id: 29, category: "Data", title: "Windows Event Logs", def: "لاگ‌های ویندوز که رخدادهای ورود، سرویس‌ها و امنیت را ثبت می‌کنند.", when: "در اکثر تحقیقات سیستم‌ها، مخصوصاً احراز هویت و دسترسی‌ها.", usage: "دیدن Logonها، تغییرات امنیتی و دسترسی‌های مشکوک.", why: "بخش بزرگی از حملات سازمانی روی ویندوز رخ می‌دهد.", how: "شناخت Event IDهای مهم (مثل 4624/4625) و جستجو در SIEM.", tips: "IDها کلیدی‌اند. Auditing درست باید در ویندوز فعال باشد.", note: "بدون لاگ کافی، تشخیص «چه کسی، چه کرد» بسیار سخت می‌شود." },
  { id: 30, category: "Tools", title: "Sysmon", def: "ابزار پیشرفته ثبت رخدادهای ویندوز (Process Creation, Network Connections).", when: "وقتی لاگ‌های پیش‌فرض ویندوز جزئیات رفتاری کافی نمی‌دهند.", usage: "تشخیص اجرای پروسس‌ها، Command Line، ایجاد فایل و تزریق کد.", why: "بسیاری از تکنیک‌های مهاجم فقط با Sysmon واضح می‌شوند.", how: "نصب و کانفیگ مناسب → تحلیل Process Tree در SIEM.", tips: "کانفیگ خوب حیاتی است. مراقب حجم بالای لاگ تولیدی باش.", note: "Sysmon با کانفیگ بد، یا نویز تولید می‌کند یا نقطه کور می‌سازد." },
  { id: 31, category: "Data", title: "Syslog", def: "استاندارد ارسال لاگ دستگاه‌های لینوکسی و شبکه‌ای به مقصد مرکزی.", when: "وقتی می‌خواهید لاگ تجهیزات مختلف را یک‌جا جمع کنید.", usage: "تمرکز دادن لاگ‌ها، مانیتورینگ و ساخت هشدار.", why: "بهترین روش تجمیع لاگ برای تجهیزات شبکه و لینوکس است.", how: "تعریف مقصد در دستگاه → فعال‌سازی ورودی در SIEM → پارس کردن (Parsing) داده.", tips: "از TCP/TLS استفاده کن تا Packet Loss نداشته باشی. NTP حیاتی است.", note: "اگر Parsing درست نباشد، لاگ هست ولی «قابل استفاده» نیست." },
  { id: 32, category: "Data", title: "DNS Logs", def: "رکورد درخواست‌های تبدیل نام دامنه به IP و پاسخ‌های آن‌ها.", when: "برای کشف بدافزارها، ارتباط با C2 و فیشینگ.", usage: "پیدا کردن دامنه‌های مشکوک، DGA و Tunneling.", why: "تقریباً هر ارتباط اینترنتی با یک درخواست DNS شروع می‌شود (ردیاب اولیه).", how: "استخراج Queryهای یک Host → تحلیل دامنه‌ها و نوع پاسخ‌ها.", tips: "حجم داده بالاست؛ فیلتر درست لازم است. دامنه‌های NXDOMAIN مهم‌اند.", note: "افزایش NXDOMAIN پشت سر هم می‌تواند نشانه DGA (بدافزار) باشد." },
  { id: 33, category: "Data", title: "Firewall Logs", def: "ثبت ترافیک اجازه داده شده یا مسدود شده (IP, Port, Action).", when: "برای بررسی ارتباطات شبکه، اسکن پورت و نشت داده (Exfiltration).", usage: "تحلیل مسیر ارتباط، تشخیص نقض سیاست و تایید اتصال‌ها.", why: "فایروال نقطه کنترل اصلی شبکه است و دید کلی به ارتباطات می‌دهد.", how: "جستجو روی IP مشکوک → بررسی Allow/Denyها و پورت‌ها.", tips: "NAT ممکن است منبع واقعی را پنهان کند. Zoneهای شبکه را بشناس.", note: "Deny زیاد همیشه حمله نیست؛ گاهی اشتباه در تنظیمات است." },
  { id: 34, category: "Data", title: "Proxy Logs", def: "ثبت آدرس‌های وب (URL) که کاربران/سیستم‌ها به آن‌ها مراجعه کرده‌اند.", when: "برای بررسی وب‌گردی، دانلود فایل و فیشینگ.", usage: "تشخیص دسترسی به سایت مخرب، دانلود Payload و نشت داده (HTTP).", why: "بسیاری از تهدیدها (مثل دانلود بدافزار) از وب شروع می‌شوند.", how: "فیلتر کاربر/Host → بررسی URLها، حجم انتقال و User-Agent.", tips: "HTTPS محتوا را مخفی می‌کند (مگر SSL Inspection باشد). Redirectها مهم‌اند.", note: "افزایش دانلود فایل‌های اجرایی از دامنه‌های جدید یک پرچم قرمز است." },
  { id: 35, category: "Data", title: "VPN Logs", def: "اطلاعات نشست‌های (Sessions) اتصال راه دور کاربران.", when: "برای بررسی دسترسی‌های ریموت و لاگین‌های غیرعادی.", usage: "تشخیص لو رفتن رمز (Credential Compromise) و کنترل ریسک.", why: "VPN درگاه ورود به سازمان است؛ حملات زیادی از اینجا شروع می‌شوند.", how: "بررسی موفقیت/شکست ورود → چک کردن IP مبدا و موقعیت جغرافیایی (Geo).", tips: "IPهای اشتراکی ISPها می‌توانند گمراه‌کننده باشند. MFA نقش حیاتی دارد.", note: "قطع و وصل سریع پشت سر هم می‌تواند تلاش اتوماتیک یا مشکل شبکه باشد." },
  { id: 36, category: "Basics", title: "Authentication", def: "رویدادهای ورود/خروج و تایید هویت کاربر در سیستم‌ها.", when: "در تقریباً همه تحقیقات: دسترسی غیرمجاز، حرکت جانبی و...", usage: "فهمیدن «چه کسی» وارد شد، «از کجا» و روی کدام سیستم.", why: "بسیاری از حملات با سرقت رمز و سوءاستفاده از دسترسی شروع می‌شوند.", how: "بررسی شکست/موفقیت ورود و نوع Logon (Interactive/Network).", tips: "سرویس‌اکانت‌ها رفتار خاصی دارند. تغییر الگو مهم‌تر از یک رخداد تکی است.", note: "یک لاگین موفق بلافاصله بعد از تعداد زیادی شکست، یک هشدار جدی است." },
  { id: 37, category: "Attacks", title: "Brute Force", def: "تلاش‌های تکراری برای حدس زدن رمز عبور تا ورود موفق شود.", when: "وقتی شکست‌های ورود زیادی از یک IP یا روی یک کاربر دیده می‌شود.", usage: "تشخیص تلاش نفوذ و فعال‌سازی دفاع (Block/MFA).", why: "یکی از رایج‌ترین روش‌های گرفتن دسترسی اولیه است.", how: "تعریف حد (Threshold) → جستجوی Success بعد از چندین Fail.", tips: "ممکن است کاربر واقعی رمز را فراموش کرده باشد. Password Spraying را چک کن.", note: "وجود MFA می‌تواند حمله را ناکام کند ولی همچنان باید بررسی شود." },
  { id: 38, category: "Attacks", title: "Phishing", def: "فریب کاربر (ایمیل/سایت جعلی) برای گرفتن رمز یا اجرای فایل مخرب.", when: "گزارش کاربر، هشدار ایمیل‌سکیوریتی یا مشاهده دانلود مشکوک.", usage: "جلوگیری از سرقت هویت و تحویل بدافزار (Malware Delivery).", why: "نقطه ضعف اصلی «انسان» است و این روش ساده و موثر است.", how: "بررسی هدر ایمیل (SPF/DKIM) → چک کردن لینک‌ها و لاگ‌های پروکسی.", tips: "دامنه‌های مشابه (Typosquatting) را جدی بگیر. سریعاً Reset Password لازم است.", note: "فیشینگ فقط ایمیل نیست؛ پیام‌رسان‌ها و QR کدها هم رایج شده‌اند." },
  { id: 39, category: "Attacks", title: "Malware", def: "نرم‌افزار مخرب برای آسیب، جاسوسی یا کنترل سیستم.", when: "هشدار EDR/AV یا مشاهده رفتارهای غیرعادی در پروسس‌ها.", usage: "تشخیص آلودگی، مهار (Containment) و پاکسازی.", why: "بدافزار می‌تواند سریعاً خسارت بزند (سرقت دیتا یا رنسوم‌ور).", how: "بررسی Hash فایل → بررسی Process Tree و پایداری (Persistence).", tips: "نام فایل معیار نیست؛ مسیر و رفتار مهم است. سیستم آلوده را Isolate کن.", note: "بدافزار ممکن است Dropper باشد (فقط بدافزار اصلی را دانلود کند)." },
  { id: 40, category: "Attacks", title: "C2 (Command & Control)", def: "کانال ارتباطی بدافزار با مهاجم برای دریافت دستور و ارسال دیتا.", when: "در تحقیق بدافزار و ارتباطات شبکه‌ای مشکوک (DNS/Firewall).", usage: "کشف سیستم‌های آلوده و قطع ارتباط مهاجم.", why: "بدون C2 مهاجم نمی‌تواند سیستم آلوده را کنترل کند.", how: "یافتن مقصدهای مشکوک → بررسی الگوی ارتباط دوره‌ای (Beaconing).", tips: "برخی C2ها روی ترافیک HTTPS عادی پنهان می‌شوند.", note: "تشخیص C2 بسیار ارزشمند است چون نشانه «آلودگی فعال» است." },
  { id: 41, category: "Attacks", title: "Lateral Movement", def: "جابه‌جایی مهاجم از یک سیستم به سیستم دیگر داخل شبکه بعد از نفوذ اولیه.", when: "مشاهده دسترسی به چندین Host یا اتصالات داخلی غیرعادی.", usage: "تشخیص گسترش نفوذ و پیدا کردن سیستم‌های درگیر.", why: "مهاجم می‌خواهد از سیستم اولیه به سرورهای حساس‌تر برسد.", how: "بررسی Logonهای شبکه‌ای و ارتباطات داخلی (RDP/SMB/WinRM).", tips: "ادمین‌ها به طور طبیعی به سیستم‌های زیادی وصل می‌شوند؛ Baseline مهم است.", note: "حرکت جانبی معمولاً بعد از دسترسی به رمز/توکن (Credential Access) رخ می‌دهد." },
  { id: 42, category: "Attacks", title: "Persistence", def: "ایجاد راهی برای دسترسی مجدد به سیستم حتی بعد از ریبوت.", when: "ایجاد Scheduled Task، سرویس جدید یا تغییر در رجیستری.", usage: "تشخیص اینکه مهاجم می‌خواهد در سیستم ماندگار شود.", why: "اگر پایداری حذف نشود، رخداد (Incident) دوباره تکرار خواهد شد.", how: "بررسی تسک‌های زمان‌بندی شده، سرویس‌ها و آیتم‌های Startup.", tips: "برخی ابزارهای IT هم تسک می‌سازند؛ Context لازم است.", note: "ماندگاری اغلب کم‌سر و صداست؛ دنبال تغییرات کوچک ولی غیرعادی باش." },
  { id: 43, category: "Attacks", title: "Privilege Escalation", def: "افزایش سطح دسترسی از کاربر عادی به ادمین یا سیستم.", when: "تغییر در گروه‌های ادمین، اجرای ابزارهای دامپ رمز یا اکسپلویت محلی.", usage: "فهمیدن اینکه مهاجم اکنون قدرت کنترل کامل سیستم را دارد.", why: "با دسترسی بالا، مهاجم راحت‌تر حرکت جانبی و سرقت دیتا انجام می‌دهد.", how: "بررسی تغییرات گروه‌ها و پروسس‌های با سطح دسترسی بالا (System).", tips: "تغییرات دسترسی را با فرآیند Change Management تطبیق بده.", note: "ارتقای دسترسی یعنی شدت رخداد (Severity) به شدت بالاتر می‌رود." },
  { id: 44, category: "Attacks", title: "Exfiltration (سرقت دیتا)", def: "انتقال داده‌های حساس از داخل سازمان به بیرون (آپلود به ابری/تونل).", when: "حجم غیرعادی آپلود، مقصد ناشناس یا ابزارهای انتقال فایل مشکوک.", usage: "جلوگیری از نشت اطلاعات و کاهش خسارت قانونی.", why: "بسیاری از حملات با هدف نهایی سرقت دیتا انجام می‌شوند.", how: "بررسی حجم آپلود در فایروال/پروکسی و بررسی DNS Tunneling.", tips: "بکاپ‌های قانونی ممکن است شبیه سرقت دیتا باشند. نوع دیتا مهم است.", note: "سرقت دیتا ممکن است بسیار آهسته و کم‌حجم (Low and Slow) انجام شود." },
  { id: 45, category: "Process", title: "Containment (مهار)", def: "محدود کردن آسیب و جلوگیری از گسترش حمله (ایزوله کردن).", when: "وقتی احتمال TP بالاست یا آلودگی تایید شده است.", usage: "کنترل سریع بحران و جلوگیری از سرایت به سایر سیستم‌ها.", why: "زمان حیاتی است؛ مهار زودتر یعنی خسارت کمتر.", how: "Isolate کردن سیستم در EDR، بلاک کردن IP در فایروال، غیرفعال سازی اکانت.", tips: "مهار می‌تواند سرویس را مختل کند؛ هماهنگی با تیم IT مهم است.", note: "Containment «درمان» نیست؛ فقط جلوگیری از بدتر شدن اوضاع است." },
  { id: 46, category: "Process", title: "Eradication (پاکسازی)", def: "حذف کامل عامل تهدید (بدافزار، بک‌دور، اکانت‌های ساخته شده).", when: "بعد از مهار و وقتی مسیر نفوذ کاملاً روشن شد.", usage: "جلوگیری از بازگشت مهاجم و پایان واقعی رخداد.", why: "اگر ریشه پاک نشود، مهاجم دوباره از همان راه باز می‌گردد.", how: "حذف فایل/سرویس مخرب، بازسازی سیستم و بستن حفره‌ها (Patch).", tips: "قبل از حذف، شواهد (Evidence) لازم را ذخیره کن.", note: "پاکسازی بدون رفع علت ریشه‌ای (مثل عوض کردن رمز لو رفته) ناقص است." },
  { id: 47, category: "Process", title: "Recovery (بازیابی)", def: "برگرداندن سیستم‌ها به حالت عادی و امن و بازگردانی سرویس.", when: "بعد از پاکسازی و وقتی می‌خواهید سرویس را آنلاین کنید.", usage: "بازگشت به عملیات عادی با ریسک کنترل‌شده.", why: "هدف نهایی برقراری سرویس به صورت امن و پایدار است.", how: "Restore از بکاپ، فعال‌سازی مرحله‌ای و مانیتورینگ شدیدتر.", tips: "قبل از برگشت کامل، اعتبارسنجی امنیتی انجام بده.", note: "بازیابی باید همراه با «مانیتورینگ پس از حادثه» برای مدتی مشخص باشد." },
  { id: 48, category: "Process", title: "RCA (تحلیل علت ریشه‌ای)", def: "پیدا کردن دلیل اصلی وقوع رخداد: «چرا این اتفاق افتاد؟»", when: "بعد از کنترل رخداد برای جلوگیری از تکرار آن.", usage: "اصلاح فرآیندها، بستن نقاط ضعف و بهبود قدرت تشخیص.", why: "اگر فقط علائم را درمان کنید، مشکل دوباره تکرار خواهد شد.", how: "مرور Timeline و شواهد → یافتن اولین نقطه ورود (Initial Access).", tips: "RCA نباید سرزنش‌محور باشد؛ باید روی اصلاح متمرکز باشد.", note: "RCA خوب یک خروجی عملی دارد: «چه تغییری بدهیم که تکرار نشود؟»" },
  { id: 49, category: "Process", title: "Playbook", def: "راهنمای مرحله‌به‌مرحله برای رسیدگی به یک نوع خاص از هشدار/رخداد.", when: "در تریاژ و پاسخ به رخداد برای انجام کار استاندارد و سریع.", usage: "یکسان‌سازی کار تیم، کاهش خطا و سرعت در تصمیم‌گیری.", why: "بدون آن هر نفر به سلیقه خود عمل کرده و نتایج ناهماهنگ می‌شود.", how: "مشخص کردن نوع هشدار → باز کردن راهنمای مربوطه → اجرای گام‌های چک و پاسخ.", tips: "باید دائماً بر اساس تهدیدهای جدید به‌روز شود. باید عملیاتی باشد.", note: "Playbook عالی یعنی اگر نیروی جدید آمد، باز هم کار درست انجام شود." },
  { id: 50, category: "Process", title: "Runbook", def: "دستورالعمل دقیق فنی برای انجام یک کار مشخص (مثل نحوه بلاک کردن IP).", when: "وقتی نیاز به اقدام عملی دقیق (Isolate, Block, Dump) دارید.", usage: "کاهش اشتباه در اجرای اقدامات فنی و هماهنگی.", why: "اقدام اشتباه فنی می‌تواند سرویس را قطع کرده یا شواهد را از بین ببرد.", how: "انتخاب Runbook مرتبط → اجرای گام‌به‌گام دستورات فنی در کنسول مربوطه.", tips: "سطح دسترسی‌ها را رعایت کن. قبل از اقدام، شواهد را حفظ کن.", note: "Playbook می‌گوید «چه کار کنیم»، Runbook می‌گوید «چطور انجام دهیم»." },
  { id: 51, category: "Process", title: "SOP", def: "روش اجرایی استاندارد و رسمی سازمان برای انجام کارهای ثابت.", when: "وقتی کار باید همیشه یکسان انجام شود (بستن تیکت، ارجاع و...).", usage: "استانداردسازی، کاهش اشتباه و حفظ کیفیت در شیفت‌های مختلف.", why: "در SOC شیفتی، SOP باعث می‌شود خروجی همه افراد یکسان بماند.", how: "پیدا کردن SOP مربوطه → انجام دقیق مراحل → ثبت هر مرحله در تیکت.", tips: "باید به‌روز باشد. استثناها باید با دلیل ثبت شوند.", note: "SOP معمولاً بر «استاندارد کیفیت» و «نحوه گزارش‌دهی» تمرکز دارد." },
  { id: 52, category: "Metrics", title: "SLA", def: "تعهد زمانی/کیفی: مثلاً «هشدار بحرانی باید ظرف ۱۵ دقیقه بررسی شود».", when: "برای مدیریت زمان پاسخ و اولویت‌بندی تیکت‌ها.", usage: "کنترل سرعت رسیدگی و شفاف کردن انتظارات از SOC.", why: "بدون SLA، سرعت واکنش سلیقه‌ای شده و ممکن است موارد مهم دیر دیده شوند.", how: "مانیتور کردن تایمر تیکت بر اساس شدت → اطلاع‌رسانی قبل از نقض زمان.", tips: "SLA را با اولویت قاطی نکن. علل تاخیر بیرونی را مستند کن.", note: "SLA هم برای «اولین پاسخ» و هم برای «حل نهایی» تعریف می‌شود." },
  { id: 53, category: "Metrics", title: "MTTD", def: "میانگین زمانی که طول می‌کشد تا SOC یک تهدید را «کشف» کند.", when: "برای سنجش کارایی سیستم‌های تشخیص (Detection) و مانیتورینگ.", usage: "نشان‌دهنده قدرت دید (Visibility) و سرعت شناسایی تیم.", why: "هرچه دیرتر کشف کنید، خسارت و دامنه رخداد بیشتر خواهد بود.", how: "محاسبه فاصله زمانی بین شروع واقعی رخداد و زمان تشخیص توسط SOC.", tips: "زمان شروع واقعی گاهی تقریبی است. کیفیت لاگ در این شاخص حیاتی است.", note: "MTTD پایین‌تر معمولاً به معنای Detection بهتر یا Visibility بیشتر است." },
  { id: 54, category: "Metrics", title: "MTTR", def: "میانگین زمانی که طول می‌کشد تا SOC به تهدید پاسخ داده و آن را حل کند.", when: "برای اندازه‌گیری سرعت عملیات پاسخ (Response) و هماهنگی تیم‌ها.", usage: "سنجش کارایی تیم در مهار و پاکسازی حوادث.", why: "پاسخ کند یعنی فرصت بیشتر برای مهاجم جهت تخریب.", how: "محاسبه زمان از لحظه تشخیص تا لحظه مهار یا حل نهایی تیکت.", tips: "وابستگی به تیم‌های دیگر (مثل تیم شبکه) را در این زمان لحاظ کن.", note: "بهبود MTTR فقط با سرعت نیست؛ با اتوماسیون و Playbook بهتر می‌شود." },
  { id: 55, category: "Basics", title: "MITRE ATT&CK", def: "چارچوب جهانی دسته‌بندی تاکتیک‌ها و تکنیک‌های حملات سایبری.", when: "برای فهم بهتر هشدارها، نگاشت (Mapping) قوانین و ساخت Use Case.", usage: "زبان مشترک بین تیم‌های امنیتی برای توصیف رفتار مهاجم.", why: "کمک می‌کند پوشش تهدیدهای SOC قابل اندازه‌گیری و استاندارد شود.", how: "نگاشت هشدار به تکنیک مربوطه → شناسایی شکاف‌ها (Gaps) در پوشش داده‌ای.", tips: "این یک نقشه راه است، نه چک‌لیست قطعی. صرفاً برچسب زدن کافی نیست.", note: "Mapping خوب کمک می‌کند بفهمی هشدار در کدام مرحله از حمله است." },
  { id: 56, category: "Basics", title: "TTP", def: "تاکتیک‌ها (هدف)، تکنیک‌ها (روش) و رویه‌ها (جزئیات اجرا) مهاجم.", when: "در گزارش‌نویسی، شکار تهدید و ساخت قوانین رفتاری.", usage: "درک الگوی حمله و پیش‌بینی قدم بعدی مهاجم.", why: "IOCها عوض می‌شوند، اما TTPها (روش کار) معمولاً ثابت و پایدارترند.", how: "ساخت الگو از شواهد رفتاری → تطبیق با چارچوب ATT&CK.", tips: "روی رفتار تمرکز کن، نه فقط روی نام بدافزار.", note: "تشخیص مبتنی بر TTP بسیار مقاوم‌تر از تشخیص مبتنی بر IOC است." },
  { id: 57, category: "Detection", title: "IOA (Indicator of Attack)", def: "نشانه‌های رفتاریِ حمله (مثل زنجیره پروسس‌ها) در حین وقوع.", when: "برای تشخیص حملات جدید یا بدون امضا (Zero-day).", usage: "کشف سریع‌تر حمله‌ها با تکیه بر «رفتار» به جای «شاخص‌های ثابت».", why: "مهاجم می‌تواند IP را عوض کند، اما عوض کردن رفتار حمله برایش سخت است.", how: "تعریف قوانین روی رفتارها (مثلاً اجرای فایل توسط Word) در EDR.", tips: "ممکن است بدون شناخت Baseline، هشدارهای اشتباه (FP) زیادی بدهد.", note: "IOA به تله‌متری (Telemetry) بسیار باکیفیت و دید عمیق وابسته است." },
  { id: 58, category: "Basics", title: "Risk (ریسک)", def: "احتمال وقوع یک تهدید ضربدر میزان خسارت ناشی از آن.", when: "در تعیین اولویت، تصمیم‌گیری ارجاع و گزارش‌دهی مدیریتی.", usage: "کمک به تصمیم‌گیری درباره تخصیص زمان و منابع تیم.", why: "همه هشدارها یکسان نیستند؛ باید اثر و احتمال را با هم سنجید.", how: "سنجش احتمال (بر اساس شواهد) و اثر (بر اساس ارزش دارایی).", tips: "ریسک برای هر سازمان متفاوت است. دلیل ریسک اعلامی را مستند کن.", note: "ریسک فقط فنی نیست؛ باید جنبه کسب‌وکار (Business) را هم دید." },
  { id: 59, category: "Basics", title: "Impact (اثر)", def: "میزان آسیب (مالی، عملیاتی، اعتباری) در صورت واقعی بودن تهدید.", when: "در تعیین شدت، تصمیم برای مهار و گزارش نهایی حادثه.", usage: "فهم اینکه «اگر این اتفاق واقعی باشد، چه بلایی سر سازمان می‌آید؟»", why: "تصمیم‌های SOC باید با ارزش دارایی‌ها و پیامدها هماهنگ باشد.", how: "بررسی نوع سیستم، حساسیت داده‌ها (مثل PII) و سطح دسترسی مهاجم.", tips: "اثر را با شواهد پشتیبانی کن، نه با حدس و ترس.", note: "Impact همان چیزی است که به مدیریت در تصمیم‌گیری کمک می‌کند." },
  { id: 60, category: "Process", title: "Alert Fatigue", def: "خستگی تحلیل‌گر به دلیل حجم بالای هشدارهای بی‌کیفیت و تکراری.", when: "وقتی SOC با سیل هشدارها مواجه است و نرخ FP بسیار بالاست.", usage: "شناخت مشکل عملیاتی و شروع فرآیند بهبود (Tuning).", why: "خستگی باعث می‌شود تحلیل‌گر موارد واقعی (TP) را بین نویزها گم کند.", how: "اندازه‌گیری نرخ FP → تیونینگ قوانین نویزساز → استفاده از اتوماسیون.", tips: "حذف هشدار بدون تحلیل خطرناک است. هدف، بالا بردن کیفیت است.", note: "خستگی از هشدار یک ریسک امنیتی واقعی است، نه فقط یک خستگی ساده." }
];

const CATEGORIES = {
  All: { icon: <Layout size={18} />, color: "bg-slate-100 text-slate-700" },
  Basics: { icon: <Shield size={18} />, color: "bg-blue-100 text-blue-700" },
  Data: { icon: <Database size={18} />, color: "bg-purple-100 text-purple-700" },
  Metrics: { icon: <Clock size={18} />, color: "bg-amber-100 text-amber-700" },
  Analysis: { icon: <FileSearch size={18} />, color: "bg-emerald-100 text-emerald-700" },
  Tools: { icon: <Terminal size={18} />, color: "bg-indigo-100 text-indigo-700" },
  Detection: { icon: <SearchCode size={18} />, color: "bg-cyan-100 text-cyan-700" },
  "Threat Intel": { icon: <ShieldAlert size={18} />, color: "bg-rose-100 text-rose-700" },
  Attacks: { icon: <AlertTriangle size={18} />, color: "bg-red-100 text-red-700" },
  Process: { icon: <Settings size={18} />, color: "bg-orange-100 text-orange-700" },
};

const App = () => {
  const [currentIdx, setCurrentIdx] = useState(0);
  const [search, setSearch] = useState("");
  const [filter, setFilter] = useState("All");
  const [showList, setShowList] = useState(false);

  const filteredData = useMemo(() => {
    return SOC_DATA.filter(item => {
      const matchesSearch = item.title.toLowerCase().includes(search.toLowerCase()) || 
                            item.def.toLowerCase().includes(search.toLowerCase());
      const matchesFilter = filter === "All" || item.category === filter;
      return matchesSearch && matchesFilter;
    });
  }, [search, filter]);

  useEffect(() => {
    setCurrentIdx(0);
  }, [filter, search]);

  const currentItem = filteredData[currentIdx];

  const nextSlide = () => setCurrentIdx(prev => (prev + 1) % filteredData.length);
  const prevSlide = () => setCurrentIdx(prev => (prev - 1 + filteredData.length) % filteredData.length);

  return (
    <div className="min-h-screen bg-slate-950 text-slate-200 font-sans p-4 md:p-8 dir-rtl" style={{ direction: 'rtl' }}>
      {/* Header */}
      <header className="max-w-6xl mx-auto mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4 border-b border-slate-800 pb-6">
        <div>
          <h1 className="text-3xl font-bold bg-gradient-to-l from-blue-400 to-emerald-400 bg-clip-text text-transparent">
            SOC Tier 1: واژه‌نامه جامع عملیاتی
          </h1>
          <p className="text-slate-500 mt-1">مرجع کامل ۶۰ اصطلاح حیاتی در مرکز عملیات امنیت</p>
        </div>
        
        <div className="flex items-center gap-3">
          <div className="relative group">
            <Search className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-blue-400 transition-colors" size={18} />
            <input 
              type="text"
              placeholder="جستجوی اصطلاح..."
              className="bg-slate-900 border border-slate-700 rounded-full py-2 pr-10 pl-4 w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all text-sm"
              value={search}
              onChange={(e) => setSearch(e.target.value)}
            />
          </div>
          <button 
            onClick={() => setShowList(!showList)}
            className={`p-2 rounded-lg transition-colors ${showList ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}
          >
            <List size={20} />
          </button>
        </div>
      </header>

      <main className="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        {/* Filters Sidebar */}
        <div className="lg:col-span-3 space-y-2">
          <h3 className="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-4 px-2">دسته‌بندی‌ها</h3>
          {Object.entries(CATEGORIES).map(([name, info]) => (
            <button
              key={name}
              onClick={() => setFilter(name)}
              className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all text-sm ${
                filter === name 
                ? 'bg-blue-500/10 text-blue-400 border border-blue-500/20' 
                : 'hover:bg-slate-900 text-slate-400 border border-transparent'
              }`}
            >
              <span className={filter === name ? 'text-blue-400' : 'text-slate-500'}>{info.icon}</span>
              {name === "All" ? "همه موارد" : name}
              {filter === name && <div className="mr-auto w-1.5 h-1.5 rounded-full bg-blue-400 shadow-[0_0_8px_rgba(96,165,250,0.6)]" />}
            </button>
          ))}
        </div>

        {/* Slide Content */}
        <div className="lg:col-span-9">
          {filteredData.length > 0 ? (
            <div className="relative group">
              {/* Slide Card */}
              <div className="bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-2xl transition-all duration-500">
                {/* Card Header */}
                <div className="bg-slate-800/50 px-8 py-6 flex items-center justify-between border-b border-slate-700">
                  <div className="flex items-center gap-3">
                    <div className={`p-2.5 rounded-xl ${CATEGORIES[currentItem.category].color}`}>
                      {CATEGORIES[currentItem.category].icon}
                    </div>
                    <div>
                      <span className="text-xs font-medium text-slate-500 uppercase tracking-widest">{currentItem.category}</span>
                      <h2 className="text-2xl font-bold text-white leading-tight">{currentItem.title}</h2>
                    </div>
                  </div>
                  <div className="text-slate-500 font-mono text-sm bg-slate-950 px-3 py-1 rounded-full border border-slate-800">
                    {currentIdx + 1} / {filteredData.length}
                  </div>
                </div>

                {/* Card Body */}
                <div className="p-8 grid grid-cols-1 md:grid-cols-2 gap-8">
                  {/* Right Column: Definition & Basics */}
                  <div className="space-y-6">
                    <section>
                      <h4 className="text-blue-400 text-xs font-bold uppercase mb-2 flex items-center gap-2">
                        <BookOpen size={14} /> تعریف و مفهوم
                      </h4>
                      <p className="text-lg text-slate-200 leading-relaxed font-medium">
                        {currentItem.def}
                      </p>
                    </section>

                    <div className="grid grid-cols-1 gap-4">
                      <div className="bg-slate-950/50 p-4 rounded-2xl border border-slate-800">
                        <h5 className="text-emerald-400 text-xs font-bold mb-2 flex items-center gap-2">
                          <Clock size={14} /> چه زمانی استفاده می‌شود؟
                        </h5>
                        <p className="text-sm text-slate-400 leading-relaxed">{currentItem.when}</p>
                      </div>
                      <div className="bg-slate-950/50 p-4 rounded-2xl border border-slate-800">
                        <h5 className="text-purple-400 text-xs font-bold mb-2 flex items-center gap-2">
                          <Target size={14} /> کاربرد اصلی
                        </h5>
                        <p className="text-sm text-slate-400 leading-relaxed">{currentItem.usage}</p>
                      </div>
                    </div>
                  </div>

                  {/* Left Column: Details */}
                  <div className="space-y-6 border-r border-slate-800 pr-0 md:pr-8">
                    <section>
                      <h4 className="text-amber-400 text-xs font-bold uppercase mb-2">چرا استفاده می‌شود؟</h4>
                      <p className="text-sm text-slate-300 leading-relaxed">{currentItem.why}</p>
                    </section>

                    <section>
                      <h4 className="text-cyan-400 text-xs font-bold uppercase mb-2">روش استفاده</h4>
                      <div className="text-sm text-slate-300 bg-slate-950 p-4 rounded-2xl border border-slate-800 whitespace-pre-line leading-relaxed italic">
                        {currentItem.how}
                      </div>
                    </section>

                    <section className="bg-slate-800/30 p-4 rounded-2xl">
                      <h4 className="text-slate-400 text-xs font-bold uppercase mb-2">نکات و توصیه‌ها</h4>
                      <p className="text-sm text-slate-400 leading-relaxed">{currentItem.tips}</p>
                    </section>
                  </div>
                </div>

                {/* Footer Note */}
                <div className="bg-blue-500/5 px-8 py-4 border-t border-blue-500/10 flex items-start gap-3">
                  <Zap size={18} className="text-blue-400 shrink-0 mt-0.5" />
                  <p className="text-sm text-blue-300/80">
                    <span className="font-bold text-blue-400 ml-2 italic">نکته مهم:</span>
                    {currentItem.note}
                  </p>
                </div>
              </div>

              {/* Navigation Controls */}
              <div className="flex items-center justify-between mt-6">
                <button 
                  onClick={prevSlide}
                  className="flex items-center gap-2 px-6 py-3 bg-slate-800 hover:bg-slate-700 rounded-2xl transition-all font-medium text-slate-300 active:scale-95"
                >
                  <ChevronRight size={20} /> مورد قبلی
                </button>
                
                <div className="hidden md:flex gap-1.5">
                   {/* Progress Indicator dots */}
                   {Array.from({ length: Math.min(filteredData.length, 10) }).map((_, i) => (
                     <div key={i} className={`h-1.5 rounded-full transition-all ${Math.floor(currentIdx / (filteredData.length / 10)) === i ? 'w-8 bg-blue-500' : 'w-1.5 bg-slate-800'}`} />
                   ))}
                </div>

                <button 
                  onClick={nextSlide}
                  className="flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 rounded-2xl transition-all font-medium text-white shadow-lg shadow-blue-600/20 active:scale-95"
                >
                  مورد بعدی <ChevronLeft size={20} />
                </button>
              </div>
            </div>
          ) : (
            <div className="h-96 flex flex-col items-center justify-center bg-slate-900 border border-slate-800 border-dashed rounded-3xl text-slate-500">
              <Search size={48} className="mb-4 opacity-20" />
              <p>نتیجه‌ای برای جستجوی شما پیدا نشد.</p>
              <button onClick={() => {setSearch(""); setFilter("All")}} className="mt-4 text-blue-400 underline">پاک کردن فیلترها</button>
            </div>
          )}
        </div>
      </main>

      {/* Grid Overlay / Quick Access */}
      {showList && (
        <div className="fixed inset-0 z-50 bg-slate-950/90 backdrop-blur-md p-6 md:p-12 overflow-y-auto">
          <div className="max-w-6xl mx-auto">
            <div className="flex justify-between items-center mb-8">
              <h2 className="text-2xl font-bold">دسترسی سریع به ۶۰ مورد</h2>
              <button onClick={() => setShowList(false)} className="p-2 bg-slate-800 rounded-full hover:bg-red-500/20 hover:text-red-400 transition-all">
                <ChevronLeft size={24} className="rotate-90" />
              </button>
            </div>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
              {SOC_DATA.map((item, idx) => (
                <button
                  key={item.id}
                  onClick={() => {
                    setFilter("All");
                    setSearch("");
                    setCurrentIdx(idx);
                    setShowList(false);
                  }}
                  className={`text-right p-4 rounded-2xl border transition-all hover:scale-[1.02] active:scale-95 ${
                    currentItem.id === item.id 
                    ? 'bg-blue-600 border-blue-400 text-white shadow-xl shadow-blue-600/30' 
                    : 'bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-700'
                  }`}
                >
                  <div className="text-[10px] opacity-60 mb-1">{item.category}</div>
                  <div className="text-sm font-bold truncate">{item.title}</div>
                </button>
              ))}
            </div>
          </div>
        </div>
      )}

      {/* Visual Support Section */}
      <footer className="max-w-6xl mx-auto mt-12 grid grid-cols-1 md:grid-cols-3 gap-6 opacity-80">
        <div className="bg-slate-900/50 p-6 rounded-2xl border border-slate-800/50">
          <Activity className="text-blue-400 mb-3" size={24} />
          <h5 className="font-bold text-slate-200 mb-2">دیدبان SOC</h5>
          <p className="text-xs text-slate-500 leading-relaxed">این واژه‌نامه منطبق بر استانداردهای NIST و MITRE ATT&CK طراحی شده تا پایه دانش فنی تیم Tier 1 را تقویت کند.</p>
        </div>
        <div className="bg-slate-900/50 p-6 rounded-2xl border border-slate-800/50">
          <ShieldAlert className="text-emerald-400 mb-3" size={24} />
          <h5 className="font-bold text-slate-200 mb-2">تمرکز بر پاسخ</h5>
          <p className="text-xs text-slate-500 leading-relaxed">هر اصطلاح در اینجا به یک اقدام عملی (Action) ختم می‌شود. هدف نهایی، کاهش MTTR و شناسایی دقیق TP است.</p>
        </div>
        <div className="bg-slate-900/50 p-6 rounded-2xl border border-slate-800/50">
          <Zap className="text-amber-400 mb-3" size={24} />
          <h5 className="font-bold text-slate-200 mb-2">یادگیری تعاملی</h5>
          <p className="text-xs text-slate-500 leading-relaxed">از دکمه جستجو و فیلترهای موضوعی برای دسترسی سریع به مفاهیم در حین شیفت کاری استفاده کنید.</p>
        </div>
      </footer>
    </div>
  );
};

export default App;